---
title: "BA project"
format:
  html:
    code-fold: true
    code-summary: "Show the code"
editor: visual
---

# **The Financial and Critical Impact of Female Representation in Films: A Study of Bechdel Test Outcomes**

## Background and Motivation

The Bechdel Test serves as a widely recognized measure of female representation in films, highlighting important discussions surrounding diversity and gender equality within the film industry. This topic is significant as it not only addresses the representation of women but also engages with broader societal issues such as gender stereotypes and equity.

The intersection of cultural metrics, exemplified by the Bechdel Test, and economic variables, including a film's budget and revenue, renders this research particularly compelling. By exploring how diversity impacts a film's commercial and critical success, the study examines two key dimensions: cultural representation and its potential economic and critical consequences.

This research aligns with the overarching goal of leveraging data-driven insights to comprehend the effects of cultural dynamics on creative industries. Through a combination of statistical, predictive, and exploratory analyses, the project aims to address questions of both social significance and commercial relevance.

## Project Objectives

### Main Objective

The primary objective of this project is to investigate the relationship between the Bechdel Test and other film-related factors, such as budget, genre, and director, on a film's revenue. The specific aims include:

-   Analyzing whether passing the Bechdel Test has a statistically significant effect on domestic gross or overall revenue.

-   Assessing if films that pass the Bechdel Test tend to win more awards or achieve higher IMDb ratings.

### Sub-goals

1.  **Predictive Modeling:** Developing a predictive model to estimate a film's success based on various factors, including the Bechdel Test result, its correlation with awards, and IMDb ratings. This model will provide insights into the probability of a film passing the Bechdel Test based on attributes such as budget, genre, and director.

2.  **Correlation Exploration:** Investigating correlations between a film's performance on the Bechdel Test and its revenue, as well as its awards and IMDb ratings, to uncover potential patterns and insights.

3.  **Trend Visualization:** Visualizing trends between films that either pass or fail the Bechdel Test and their associated economic data, including revenues, budgets, awards won, and IMDb ratings. This visualization will help elucidate the relationship between female representation and film success.

## Research Questions

In this section, we pose the following research questions to explore the potential influence of female representation in films on commercial and critical success. By examining correlations between Bechdel Test results and metrics like revenue, awards, and IMDb ratings, we aim to identify patterns that link gender diversity with performance outcomes. Additionally, we explore predictive models to assess whether factors such as budget, genre, and director can reliably estimate both a film’s success and its likelihood of passing the Bechdel Test. These questions guide our analysis to uncover data-driven insights into the economic and critical impact of gender representation in the film industry.

1.  Is there a significant correlation between passing the Bechdel test and a film's revenue?
2.  Do films that pass the Bechdel test tend to win more awards or receive higher IMDb ratings? 
3.  Can we build a predictive model to estimate a film’s success (revenue, awards, IMDb ratings) based on the Bechdel test results and other factors like budget, genre, and director?
4.  Can we develop a predictive model to determine whether a film will pass the Bechdel test based on factors such as budget, genre, and director?

## Data Collection

In this section, we outline the process of data collection and merging. The data sources for this project were obtained from data.world, where we can access to the following datasets:

-   **Dataset df:** It contains information regarding the Bechdel test outcomes for various films. The information was gather from BechdelTest.com and The-Numbers.com

-   **Dataset df2:** It includes additional film-related data, such as budget, revenue, genre, director, and awards. This information comes from the Imdb dataset.

The two datasets were successfully merged into a single primary data frame using the IMDb ID as the key. This process resulted in a consolidated dataset comprising 1,792 rows. Specific columns of interest were selected to facilitate further analysis and ensure the relevance of the data to our research objectives.

```{r}
library(jsonlite)
library(dplyr)
library(tidyr)
library(stringr)
library(tidyverse)
library(RColorBrewer)
library(ggplot2)
library(plotly)
```

```{r}
# Read json file
df <- fromJSON("https://query.data.world/s/mel73qzc35dvjcs54h4x4tatmvveaj?dws=00000")

# Read csv file
df2 <- read.csv("https://query.data.world/s/zosxjqvjiygclw2wix74pcp4vyesvb?dws=00000", header=TRUE, stringsAsFactors=FALSE);

#Merge the two dataset
merged_data <- merge(df2, df, by.x = "imdb", by.y = "imdbID", all = FALSE)

#Remove unwanted columns
df_final <- subset(merged_data, select = -c(domgross_2013.,Writer,Year, Actors, imdb, title, test, clean_test, domgross, intgross, Plot, code, period.code,decade.code, budget, Rated, Response, Metascore, Released, Runtime, Type, Poster, Error ))
```

## Data Cleaning

In the data cleaning section, we ensure the dataset is prepared for effective analysis by addressing any inconsistencies, missing values, and irrelevant entries. This process involves examining each variable to standardize formats, handle null values, and remove duplicates, ultimately enhancing the accuracy and reliability of the Exploratory Data Analysis and modeling phases. By refining the dataset, we lay a strong foundation for meaningful insights and trustworthy results in subsequent analyses.

1.  **Standardizing Column Names**\
    This section focuses on renaming columns to create a consistent and clear naming convention across the dataset, ensuring easier readability and usability for analysis.

```{r}
#Rename column

df_final <- df_final %>% 
  rename( Year = year, Bechdel_test_result = binary, Budget = budget_2013., Revenue = intgross_2013., Movie_Title = Title, Country_of_Origin = Country, Imdb_Rating = imdbRating, Imdb_Votes = imdbVotes)

```

2.  **Isolating Individual Values by Language, Genre, and Director**\
    Here, we separated entries with multiple values in the *Language*, *Genre*, and *Director* columns, creating distinct rows for each value. This transformation enables more granular analysis by ensuring each entry corresponds to a single language, genre, or director.

```{r}
# Seperate the language

df_final <- df_final %>%
  separate_rows(Language, sep = ", ")

# Seperate the Genre
df_final <- df_final %>%
  separate_rows(Genre, sep = ", ")

# Seperate the Director
df_final <- df_final %>%
  separate_rows(Director, sep = ", ")

```

3.  **Extracting and Summarizing Award Wins and Nominations**\
    In this section, we parsed the *Awards* column to isolate and categorize Oscar and other award wins and nominations. By extracting relevant numerical values, we created separate columns for *Wins* and *Nominations*, enabling a more detailed analysis of award performance. Intermediate columns were removed to streamline the dataset.

```{r}
# Extract Wins and Nominations
# Updated code to process each row individually
df_final <- df_final %>%
  rowwise() %>%
  mutate(
    # Extract numbers after "Won " and before "wins"
    oscar_wins = replace_na(
      str_extract(Awards, "(?i)(\\d+)(?= win(s)?)") %>%
        str_replace_all("Another ", "") %>%
        as.numeric(), 
      0),
    
    # Extract numbers before "win(s)"
    other_wins = replace_na(
      str_extract(Awards, "(?i)\\bWon (\\d+)") %>%
        str_replace_all("Won ", "") %>%
        as.numeric(),
      0),
    
    Wins = rowSums(across(c(oscar_wins, other_wins))),
    
    oscar_nominations = replace_na(
      str_extract(Awards, "(?i)\\bNominated for (\\d+)") %>%
        str_replace_all("Nominated for ", "") %>%
        as.numeric(), 
      0),
    other_nominations = replace_na(
      str_extract(Awards, "(?i)(\\d+)(?= nomination(s)?)") %>%
        str_replace_all("Nominated ", "") %>%
        as.numeric(),
      0),
    
    Nominations = rowSums(across(c(oscar_nominations, other_nominations))),
  ) %>%
  select(-Awards, -oscar_wins, -other_wins, -oscar_nominations, -other_nominations) %>%  # Remove intermediate columns
  ungroup() # Ungroup after rowwise operations

```

4.  **Integrating Director Gender for Analysis**

    To explore the potential impact of a director's gender on a film’s performance in the Bechdel Test, we extended our dataset by merging it with an external table that maps names to gender. This table associates names with specific genders, where:

    -   male = 1

    -   Female = 0

    -   Unisex = 3

    For the purposes of our analysis, we assume these name-gender associations are accurate (e.g., "James" is classified as male). Given that only 101 out of 1,792 records are marked as unisex or have missing gender values, we decided to exclude these records when examining gender’s impact on other variables.

```{r}
library(DT) 
# Open the dataset with the names associated with a gender
df_name <- read.csv("https://query.data.world/s/vosjabgwxpybit5vkwjkyv7przl6km?dws=00000", header=TRUE, stringsAsFactors=FALSE)


# Rename column for consistency
df_name <- df_name %>% 
  rename(Gender = gender)

# Separate the column 'Director' in df_final into 'Name' and 'Last_Name' at the first space
df_final <- df_final %>%
  separate(Director, into = c("Name", "Last_Name"), sep = " ", extra = "merge", fill = "right")

# Merge the datasets on the 'Name' column to match the director's name to a gender
df_final_gender <- df_final %>%
  left_join(df_name, by = c("Name" = "name")) %>%
  select(-score)  # Remove unnecessary column

# Create the interactive table
datatable(df_final_gender, 
          options = list(pageLength = 10,  # Number of rows 
                         autoWidth = TRUE, 
                         searchHighlight = TRUE),
          filter = 'top')  # add search filter to the top

```

5.  **Reconstructing the Director's Full Name**\
    In this step, we recreate a column that combines the director's first and last name. If the last name is missing, we use only the first name; otherwise, both names are concatenated. This provides a consistent format for the director's name across the dataset, which we store in the new column *Director_Name*. We then remove the *Name* and *Last_Name* columns to streamline the dataset.

```{r}
# Recreate a column with the directors name
df_final_gender$Director_Name <- ifelse(
  is.na(df_final_gender$Last_Name), 
  df_final_gender$Name, 
  paste(df_final_gender$Name, df_final$Last_Name)
)

df_final <- df_final_gender %>%
  select(-Name, -Last_Name)


```

6.  **Converting Bechdel Test Results to Binary Format**\
    We create a binary column, *Bechdel_binary*, to indicate whether each film passed the Bechdel Test, where a "PASS" result is represented as **`1`** and a "FAIL" result as **`0`**. This binary format allows for easier analysis and statistical modeling.

```{r}
# Adding a column of Bechdel_test_result as binary
df_final$Bechdel_binary <- as.factor(ifelse(df_final$Bechdel_test_result == "PASS", 1, 0))
```

7.  **Ensuring Correct Variable Types for Exploratory Data Analysis**\
    To prepare for exploratory data analysis, we set appropriate data types for each variable. *Gender*, *Genre*, *Language*, *Country_of_Origin*, *Bechdel_test_result*, and *Bechdel_binary* are converted to categorical variables, while *Revenue*, *Imdb_Rating*, and *Imdb_Votes* are transformed to numeric types for accurate calculations.

```{r}
# To make sure our EDA works we need to make sure the type of the variable is correct
# Gender, Genre, language --> to categorical
df_final[c ("Gender","Genre", "Language", "Country_of_Origin", "Bechdel_test_result", "Bechdel_binary")] <- lapply (df_final [c("Gender","Genre", "Language", "Country_of_Origin", "Bechdel_test_result", "Bechdel_binary")], as.factor)

#Revenue, Imdb_Rating,Imdb_Votes :from character to numeric
df_final$Imdb_Votes <- as.numeric(gsub(",", "", df_final$Imdb_Votes))
df_final[c("Revenue", "Imdb_Rating", "Imdb_Votes")] <- lapply(df_final[c("Revenue", "Imdb_Rating", "Imdb_Votes")], as.numeric)

# Display a table with variable names and data types only
variable_info <- data.frame(Variable = names(df_final), Type = sapply(df_final, class))
print(variable_info)

```

8.  **Handling Missing Values**\
    After checking for missing values, we find that *Revenue* and *Gender* have some `NA` entries. Since these missing values could impact analysis, we remove rows with any `NA` values to maintain data integrity in the final dataset.

```{r}
na_counts <- colSums(is.na(df_final)) ## 32 NA in Revenue and 342 in Gender
df_final <- na.omit(df_final)

```

9.  **Variables and Descriptions after the cleaning**

-   **Year (Release Date)**\
    • **Description**: The year when the film was released to the public.\
    • **Type**: Integer.

-   **Bechdel Test Result (Passed/Failed)**\
    • **Description**: This variable indicates whether the film passed or failed the Bechdel test, a measure of gender representation in films.\
    • **Type**: Categorical/factor with possible values "Passed" or "Failed."

-   **Budget (in \$)**\
    • **Description**: The production budget of the film in U.S. dollars, adjusted for inflation to reflect 2013 dollar values.\
    • **Type**: Numeric, stored as an integer.

-   **Revenue (in \$)**\
    • **Description**: The total revenue or box office earnings of the film in U.S. dollars, adjusted for inflation to 2013 prices.\
    • **Type**: Numeric.

-   **Language**\
    • **Description**: The primary language(s) in which the film was released or broadcast, represented by specific languages such as "English" or "French."\
    • **Type**: Categorical/factor.

-   **Movie Title**\
    • **Description**: The name of the film, provided as text.\
    • **Type**: Text (Character).

-   **Country of Origin**\
    • **Description**: The country where the film was produced or primarily distributed, provided as the country’s name (e.g., "USA", "France").\
    • **Type**: Categorical/factor.

-   **IMDb Ratings**\
    • **Description**: The film’s IMDb rating, often based on user reviews and ratings on the IMDb platform.\
    • **Type**: Numeric.

-   **Genre (Action, Drama, Comedy, etc.)**\
    • **Description**: The primary genre(s) describing the film, such as Action, Drama, or Comedy.\
    • **Type**: Categorical/factor.

-   **IMDb Votes**\
    • **Description**: The number of user reviews for the film’s IMDb rating on the IMDb platform.\
    • **Type**: Numeric.

-   **Wins**\
    • **Description**: The number of awards the film has won (e.g., "Golden Globe", "Oscar").\
    • **Type**: Numeric.

-   **Nominations**\
    • **Description**: The number of nominations for awards the film has received.\
    • **Type**: Numeric.

-   **Gender (Director’s Gender)**\
    • **Description**: The gender of the film's director.\
    • **Type**: Categorical/factor.

-   **Director Name**\
    • **Description**: The name of the director of the film.\
    • **Type**: Text (Character).

-   **Bechdel Binary**\
    • **Description**: This variable indicates whether the film passed (1) or failed (0) the Bechdel test.\
    • **Type**: Categorical/factor with possible values "Passed = 1" or "Failed = 0."

## Exploratory Data Analysis

This exploratory analysis aims to uncover relationships between female representation in films, as measured by the Bechdel test, and their commercial success as indicated by revenue and awards. By visualizing the data and assessing correlations among these variables, we can gain insights into the impact of diversity in film on its critical and financial performance.

1.  **Creating a Deduplicated Dataset for Analysis**\
    In this step, we create a deduplicated dataset based on unique film titles. This dataset will be used for analysis in all columns except for *Genre* and *Language*. By grouping the data by *Movie_Title* and selecting the first occurrence of each variable, we ensure that only one entry per film is considered for analysis. We then summarize the dataset to count the number of distinct values in each column, providing an overview of the diversity within the data.

```{r}
library(DT)
# Create a deduplicated dataset based on unique film titles
df_unique <- df_final %>% 
  group_by(Movie_Title) %>% 
  summarise(across(everything(), ~ first(.)))

# Summarize the number of distinct values for each column
summary_data <- df_unique %>%
  summarise(across(everything(), ~ n_distinct(.)))

# Convert the summary data to an interactive table using DT
summary_data_table <- datatable(summary_data, options = list(pageLength = 5))

# Print the interactive table
summary_data_table


```

\

2.  **Summarizing Categorical Variables**\
    In this step, we summarize the categorical variables, including *Bechdel_test_result*, *Genre*, *Gender*, and *Bechdel_binary*, by counting the occurrences of each unique category. This provides an overview of the distribution of these variables in the dataset, which is essential for understanding their role in the analysis.

```{r}
#install.packages("DT")
library(DT)
# Summarize the Bechdel test result, Genre, and Gender with counts
bechdel_test_summary <- df_unique %>%
  count(Bechdel_test_result, name = "count") %>%
  rename(Category = Bechdel_test_result) %>%
  mutate(Variable = "Bechdel_test_result") # Add the variable name

genre_summary <- df_unique %>%
  count(Genre, name = "count") %>%
  rename(Category = Genre) %>%
  mutate(Variable = "Genre of the film") # Add the variable name

gender_summary <- df_unique %>%
  count(Gender, name = "count") %>%
  rename(Category = Gender) %>%
  mutate(Variable = "Gender of Directors") # Add the variable name

# Create interactive tables with DT
bechdel_test_table <- datatable(bechdel_test_summary, options = list(pageLength = 5))
genre_summary_table <- datatable(genre_summary, options = list(pageLength = 5))
gender_summary_table <- datatable(gender_summary, options = list(pageLength = 5))

# Print the interactive tables
bechdel_test_table
genre_summary_table
gender_summary_table
```

3.  **Summarizing Numerical Variables**\
    In this step, we summarize the key numerical columns, including *Budget*, *Revenue*, *Imdb_Rating*, *Imdb_Votes*, *Wins*, and *Nominations*. This summary provides descriptive statistics for these variables, offering insights into their distribution and range, which are essential for understanding their role in the analysis of film performance.

```{r}

library(DT)

# Summarize the numerical columns
numerical_summary <- summary(df_unique[, c("Budget", "Revenue", "Imdb_Rating", "Imdb_Votes", "Wins", "Nominations")])

# Convert the summary into a data frame for easier viewing
numerical_summary_df <- as.data.frame(numerical_summary)

# Convert the numerical summary data to an interactive table using DT
numerical_summary_table <- datatable(numerical_summary_df, options = list(pageLength = 6))

# Print the interactive table
numerical_summary_table
```

### Correlation Heatmap: Revenue, Budget, Imdb_Rating, Wins, Nominations, Bechdel_binary

In this step, we present a correlation heatmap that displays the relationships between key variables: **Revenue**, **Budget**, **IMDb Rating**, **Wins**, **Bechdel_binary** and **Nominations**. By examining the correlation coefficients between these variables, this heatmap provides insights into the degree and direction of association among financial, critical, and award-related metrics. Positive correlations indicate that as one variable increases, the other tends to increase as well, while negative correlations suggest an inverse relationship. This visualization serves as a preliminary analysis, helping us identify which factors are most closely linked, and providing a basis for further exploration of the economic and critical impacts of female representation in films.

```{r}

# Select relevant columns including Bechdel_binary (which has values 0 and 1)
num_cols <- df_unique %>% 
  select(Revenue, Budget, Imdb_Rating, Wins, Nominations, Bechdel_binary)  %>%
  mutate(across(everything(), as.numeric))

# Calculate the correlation matrix with complete observations only
corr_matrix <- cor(num_cols, use = "complete.obs")

# Convert correlation matrix to long format for ggplot
corr_long <- corr_matrix %>%
  as.data.frame() %>%
  rownames_to_column(var = "Var1") %>%
  pivot_longer(cols = -Var1, names_to = "Var2", values_to = "value")

# Create the heatmap with correlation values displayed on the tiles
heatmap <- ggplot(corr_long, aes(x = Var1, y = Var2, fill = value)) +
  geom_tile(color = "white") +
  scale_fill_gradient2(low = "blue", high = "red", mid = "white", midpoint = 0, limit = c(-1, 1)) +
  geom_text(aes(label = round(value, 2)), color = "black", size = 4) +  # Display correlation values
  labs(title = "Correlation Heatmap: Revenue, Budget, Imdb_Rating, Wins, Nominations, Bechdel Test", 
       x = "", y = "", fill = "Correlation") +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5),  # Center the title
    axis.text.x = element_text(angle = 45, hjust = 1)
  )

# Make the heatmap interactive with Plotly
ggplotly(heatmap)
```

### Interpretation:

#### **High Positive Correlations:**

1.  **Budget and Revenue (0.60)**: There is a strong positive correlation between budget and revenue. This suggests that films with higher production budgets tend to generate higher box office revenues. Higher budgets typically allow for better marketing, production, and star power, contributing to greater commercial success.

2.  **Wins and Nominations (0.79)**: A very strong positive correlation, indicating that films with more nominations generally win more awards. This highlights the likelihood that films nominated for prestigious awards are often the ones that take home the honors.

#### **Moderate Correlations:**

1.  **IMDb Rating and Nominations (0.48)**: There is a moderate positive correlation between IMDb ratings and nominations. Films with better ratings from audiences tend to receive more nominations, suggesting that critical success often paves the way for recognition in award circles.

#### **Weak or No Correlations:**

1.  **Budget and IMDb Rating (-0.04)**: There is virtually no correlation between the budget of a film and its IMDb rating, indicating that the amount spent on production does not necessarily correlate with higher user ratings. Audience ratings are influenced by various other factors, such as the story, acting, and direction.

2.  **Wins and IMDb Rating (0.06)**: The correlation between wins and IMDb ratings is very weak, suggesting that winning awards does not strongly impact the audience's ratings. A film can be successful in terms of awards but may not necessarily receive high ratings from the audience.

3.  **Bechdel Binary (0.00 to -0.15 with other variables)**: The Bechdel binary variable (indicating whether a film passed or failed the Bechdel test) shows very weak correlations with other variables, suggesting that passing the Bechdel test does not have a significant relationship with budget, revenue, IMDb rating, or wins. For example:

    -   **Bechdel_binary and Revenue (-0.10)**: A very weak negative correlation, meaning that whether a film passes the Bechdel test has almost no influence on its revenue.

    -   **Bechdel_binary and Budget (-0.15)**: A weak negative correlation, showing that films passing the Bechdel test are slightly less likely to have larger budgets, though the relationship is not strong.

    -   **Bechdel_binary and IMDb Rating (-0.13)**: A slightly negative correlation, indicating a small negative relationship between passing the Bechdel test and IMDb ratings. However, the correlation is weak.

### Revenue Distribution by Bechdel Test Outcome

In this step, we examine the distribution of movie revenues based on whether films pass or fail the Bechdel Test. Using a violin plot overlaid with boxplots, we visualize the log-transformed revenue to handle any large variances in revenue data, which allows us to better observe patterns across Bechdel Test outcomes. This visualization helps us assess whether movies that pass the Bechdel Test tend to have different revenue distributions compared to those that fail, providing preliminary insights into the financial impact of female representation in films.

```{r}


# Check for any missing or NA values in the Revenue column to ensure data integrity
df_unique <- df_unique %>% drop_na(Revenue)

# Create the interactive plot with specified colors
plot <- ggplot(df_unique, aes(x = factor(Bechdel_binary), y = log(Revenue), fill = factor(Bechdel_binary))) +
  geom_violin(alpha = 0.7) +
  geom_boxplot(width = 0.2, alpha = 0.8, outlier.shape = NA) +
  scale_fill_manual(values = c("0" = "#FF7F50", "1" = "#4CAF50"), labels = c("Fail", "Pass")) +
  scale_x_discrete(labels = c("0" = "Fail", "1" = "Pass")) +
  labs(
    title = "Movie Revenue Distribution by Bechdel Test Result",
    subtitle = "Log of Revenue",
    x = "Bechdel Test Result",
    y = "Revenue (Log Scale)",
    fill = "Bechdel Test Result\n(0 = Fail, 1 = Pass)"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
    plot.subtitle = element_text(hjust = 0.5, size = 10),
    legend.position = "bottom",
    axis.text = element_text(size = 10),
    axis.title = element_text(size = 12)
  )


ggplotly(plot)
```

### Interpretation:

According this violin plot that illustrates the revenue distribution for films based on their Bechdel Test results. Films that **fail the Bechdel Test** generally show a **higher median revenue** compared to those that pass. Additionally, the revenue distribution for failing films has greater variability, with some reaching notably high revenues, while others fall to lower extremes, as shown by the extended tails of the violin plot. In contrast, films that **pass the Bechdel Test** have a more condensed revenue distribution, indicating less variability and a slightly lower median revenue.

Overall, this suggests that films failing the Bechdel Test may achieve higher revenues on average, though the reasons behind this trend likely involve other factors, such as genre or marketing, which would require further analysis to clarify.

### Revenue Distribution by Genre and Bechdel Test Outcome

In this section we use a boxplot that compares film revenues across different genres, with results segmented by whether the films pass or fail the Bechdel Test.

```{r}

# interactive plot
plot <- ggplot(df_final, aes(x = Genre, y = Revenue, fill = factor(Bechdel_binary))) +
  geom_boxplot(outlier.shape = NA, alpha = 0.8) +  # Set transparency for better visibility
  scale_y_log10() +  # Log scale to handle revenue variability
  labs(
    title = "Revenue Distribution by Genre and Bechdel Test Result",
    subtitle = "Comparing Revenue Across Genres by Bechdel Test Outcome",
    x = "Genre", 
    y = "Revenue (Log Scale)", 
    fill = "Bechdel Test Result\n(0 = Fail, 1 = Pass)"
  ) +
  scale_fill_manual(values = c("0" = "#FF7F50", "1" = "#4CAF50"),  # Orange for Fail, Green for Pass
                    labels = c("Fail", "Pass")) +
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14),  # Centered title
    plot.subtitle = element_text(hjust = 0.5, size = 10),  # Centered subtitle
    axis.text.x = element_text(angle = 45, hjust = 1, size = 10),  # Rotate genre labels
    axis.title = element_text(size = 12),
    legend.position = "bottom"  # Move legend to bottom for more space
  )

# Convert to interactive plot
ggplotly(plot)
```

### Interpretation:

The plot suggests that while revenue varies significantly across genres, the Bechdel Test result does not have a consistent impact on revenue within each genre. Certain genres like Adventure, Sci-Fi, and Action show generally higher revenues, but this trend appears irrespective of the Bechdel Test outcome.

### Revenue vs. IMDb Rating Scatter Plot with Bechdel Test Outcome

This scatter plot visualization provides insight into the relationship between a film's IMDb rating and its revenue, while highlighting the results of the Bechdel Test as a key variable. It aims to observe any trends in rating and revenue associated with gender representation. A smooth trend line added to the data helps to highlight overarching patterns, while a logarithmic scale on the revenue axis accounts for the large revenue disparities often found across films.

```{r}

# Load necessary libraries
library(ggplot2)
library(plotly)

# Your ggplot code
p <- ggplot(df_unique, aes(x = Imdb_Rating, y = Revenue, color = factor(Bechdel_binary))) +
  geom_point(alpha = 0.6) +
  geom_smooth(method = "loess", se = FALSE) +  # Add trend lines without confidence intervals
  scale_y_log10() + 
  scale_color_manual(values = c("0" = "#FF7F50", "1" = "#4CAF50")) +  # Set colors for Bechdel_binary
  labs(title = "Revenue vs. IMDb Rating by Bechdel Test Result",
       x = "IMDb Rating", y = "Log of Revenue", color = "Bechdel Test Result\n(0 = Fail, 1 = Pass)") +
  theme_minimal()

ggplotly(p)

```

Passing the Bechdel Test does not appear to have a major impact on revenue, as both passing and failing movies follow similar trends in terms of IMDb Rating and Revenue. Instead, IMDb rating itself seems to be the stronger indicator of revenue potential across both groups, though this effect is relatively modest

### Wins by Bechdel Test Result 

```{r}

# Using dplyr to create summary statistics
summary_stats <- df_unique %>%
  group_by(Bechdel_binary) %>%
  summarise(
    Mean_Wins = mean(Wins, na.rm = TRUE),
    Median_Wins = median(Wins, na.rm = TRUE),
    Count = n()
  ) %>%
  mutate(
    Mean_Wins = round(Mean_Wins, 2),
    Median_Wins = round(Median_Wins, 2)
  )

summary_stats
```

We see that failing the test is more common. The average number of win remains the same but the change is that 50% of films that passed the test had at least 4 awards and for those failing the test, 50% of them had at least 3 awards.

```{r}

library(plotly)

# Create the interactive plot
plot <- ggplot(df_unique, aes(x = Bechdel_binary, y = Wins, fill = Bechdel_binary)) +
  geom_boxplot(outlier.shape = NA) +
  labs(title = "Awards by Bechdel Test Result",
       x = "Bechdel Test Result", 
       y = "Number of Awards",
       fill = "Bechdel Test Result\n(0 = Fail, 1 = Pass)") +
  scale_fill_manual(values = c("0" = "#FF7F50", "1" = "#4CAF50")) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5)) +
  ylim(0,20) +  # Set y-axis limits to 0 and 45
  # Add text annotation with statistics
  annotate("text", 
           x = 1:2, 
           y = 45,  # Position the text at the top of the y-axis
           label = paste("Mean:", round(tapply(df_final$Wins, df_final$Bechdel_binary, mean, na.rm = TRUE), 2),
                         "\nMedian:", round(tapply(df_final$Wins, df_final$Bechdel_binary, median, na.rm = TRUE), 2)),
           vjust = -0.5)

ggplotly(plot)

```

### IMDb Ratings by Bechdel Test Result

```{r}

library(tidyr)
library(ggplot2)
library(plotly)

# Create the interactive plot
plot <- ggplot(df_unique, aes(x = factor(Bechdel_binary), y = Imdb_Rating, fill = factor(Bechdel_binary))) +
  geom_boxplot(outlier.shape = NA) +
  labs(title = "IMDb Ratings by Bechdel Test Result",
       x = "Bechdel Test Result", y = "IMDb Rating",  fill = "Bechdel Test Result\n(0 = Fail, 1 = Pass)") +
  scale_fill_manual(values = c("0" = "#FF7F50", "1" = "#4CAF50")) +
  theme_minimal() + 
  theme(plot.title = element_text(hjust = 0.5))

ggplotly(plot)
```

### Trend Analysis Over Time (Percentage of Movies Passing Bechdel Test)

```{r}

library(dplyr)
library(ggplot2)
library(plotly)

# Calculate the percentage of movies passing the Bechdel test by year
df_trend <- df_unique %>%
  group_by(Year) %>%
  summarize(pass_rate = mean(Bechdel_binary == 1, na.rm = TRUE) * 100)

# Create the interactive plot
plot <- ggplot(df_trend, aes(x = Year, y = pass_rate)) +
  geom_line(color = "blue") +
  geom_point(color = "blue") +
  labs(title = "Percentage of Movies Passing the Bechdel Test Over Time",
       x = "Year", y = "Percentage Passing Bechdel Test") +
  theme_minimal() + 
  theme(plot.title = element_text(hjust = 0.5))

ggplotly(plot)
```

## Gender of Director impact

This part will explore how the gender of the director impact the data such as the budget, the revenue, the Imdb score, and the Bechedel test

```{r}

ggplot(
  data = df_unique %>% filter(Gender %in% c(0, 1)),
  mapping = aes(x = as.factor(Gender), fill = as.factor(Gender))
) +
  geom_bar(width = 0.5) +  # Set bar width here
  labs(
    x = "Director Gender (1 = Male, 0 = Female)",  # Label for x-axis
    y = "Count",                                   # Label for y-axis
    title = "Count of Films by Director Gender",
    fill = "Gender"
  ) +
  scale_fill_manual(values = c("#DB9ADB", "#4062DB")) +  # Customize colors for each gender
  ylim(0, 2000) +  # Set y-axis limit
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5),
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 10)
  ) +
  geom_text(
    stat = "count",
    aes(label = ..count..),  # Show count on top of each bar
    vjust = -0.5,
    position = position_dodge(width = 0.5)  # Aligns text to center of each bar width
  )

```

```{r}
# Director VS budget
ggplot(
  data = df_unique %>% filter(Gender %in% c(0, 1)),
  mapping = aes(x = factor(Gender), y = log(Budget), fill = factor(Gender))
) +
  geom_boxplot(outlier.shape = NA) +  # Hide outliers if they clutter the plot
  scale_fill_manual(values = c("0" = "#DB9ADB", "1" = "#4062DB")) +  # Color for male (0) and female (1)
  labs(title = "Budget Distribution by Director Gender",
       x = "Director Gender (1 = Male, 0 = Female)",
       y = "Log of Budget",
       fill = "Gender") +
  theme_minimal()

```

**Gender vs Revenue**

```{r}

df_unique %>%
  filter(Gender %in% c(0, 1)) %>%
  group_by(Gender) %>%
  summarize(
    Mean_Revenue = mean(Revenue, na.rm = TRUE),
    Median_Revenue = median(Revenue, na.rm = TRUE),
    Count = n()
  )
```

### Genre of movies

```{r}

# What genre pass the test, we use df_final because we look at the genre column
df_pass <- df_final %>%
  filter(Bechdel_binary == 1)

data_genre <- df_pass %>%
  group_by(Genre) %>%
  summarize(count = n()) %>%
  mutate(percentage = count / sum(count) * 100)

# Reorder Genre by percentage
data_genre <- data_genre %>%
  mutate(Genre = fct_reorder(Genre, percentage, .desc = TRUE))
palette_21 <- c("#66c2a5", "#fc8d62", "#8da0cb", "#e78ac3", "#a6d854", 
                "#ffd92f", "#e5c494", "#b3b3b3", "#1f78b4", "#33a02c", 
                "#e31a1c", "#ff7f00", "#6a3d9a", "#b15928", "#a6cee3",
                "#fb9a99", "#fdbf6f", "#cab2d6", "#ffff99", "#b2df8a", "#5A9BD5")
# Plot with reordered genres
ggplot(data_genre, aes(x = "", y = percentage, fill = Genre)) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar("y") +
  scale_fill_manual(values = palette_21) + 
  labs(title = "Distribution of Genres Among Movies Passing the Bechdel Test",
       fill = "Genre") +
  theme_void() +
  geom_text(aes(label = ifelse(percentage > 3, paste0(round(percentage, 1), "%"), "")),
            position = position_stack(vjust = 0.5))

```

```{r}

# What about the ones that fail
df_fail <- df_final %>%
  filter(Bechdel_binary == 0)

data_genre <- df_fail %>%
  group_by(Genre) %>%
  summarize(count = n()) %>%
  mutate(percentage = count / sum(count) * 100)

# Reorder Genre by percentage
data_genre <- data_genre %>%
  mutate(Genre = fct_reorder(Genre, percentage, .desc = TRUE))

palette_22 <- c("#8DA0CB", "#E78AC3", "#66C2A5", "#FC8D62", "#FFD92F", 
                "#A6D854", "#B3B3B3", "#E5C494", "#FF7F00", "#1F78B4", 
                "#6A3D9A", "#E31A1C", "#33A02C", "#CAB2D6", "#FB9A99",
                "#A6CEE3", "#B15928", "#B2DF8A", "#5A9BD5", "#FFFF99", "#FDBF6F")

# Plot with reordered genres
ggplot(data_genre, aes(x = "", y = percentage, fill = Genre)) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar("y") +
  scale_fill_manual(values = palette_22) + 
  labs(title = "Distribution of Genres Among Movies failing the Bechdel Test",
       fill = "Genre") +
  theme_void() +
  geom_text(aes(label = ifelse(percentage > 3, paste0(round(percentage, 1), "%"), "")),
            position = position_stack(vjust = 0.5))
```

```{r}

# Calculate counts and percentages by Gender and Bechdel Test result
data_gender_bechdel <- df_unique %>%
  filter(Gender %in% c(0, 1)) %>%
  group_by(Gender, Bechdel_binary) %>%
  summarize(count = n()) %>%
  group_by(Gender) %>%
  mutate(percentage = count / sum(count) * 100)

# Plot
ggplot(data_gender_bechdel, aes(x = as.factor(Gender), y = count, fill = as.factor(Bechdel_binary))) +
  geom_bar(stat = "identity", width = 0.5, position = "fill") +  # Use position = "fill" for percentage stack
  labs(
    x = "Director Gender (0 = Female, 1 = Male)",  # Label for x-axis
    y = "Percentage of Movies",                    # Label for y-axis
    title = "Percentage of Films Passing the Bechdel Test by Director Gender",
    fill = "Bechdel Test Result\n(0 = Fail, 1 = Pass)"
  ) +
  scale_fill_manual(values = c("0" = "#FF7F50", "1" = "#4CAF50")) +  # Customize colors for pass/fail
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5),
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 10)
  ) +
  geom_text(
    aes(label = paste0(round(percentage, 1), "%")),
    position = position_fill(vjust = 0.5),  # Center text within each stack
    color = "white",
    size = 3
  )

```

Unsurprisingly, female directors are better in passing Bechdel test.

```{r}

# Count Bechdel_binary values grouped by Gender
counts <- df_unique %>%
  group_by(Gender, Bechdel_binary) %>%
  summarise(count = n(), .groups = 'drop') %>%
  mutate(
    Gender_desc = case_when(
      Gender == 0 ~ "Female",
      Gender == 1 ~ "Male",
      Gender == 3 ~ "Unisex"
    ),
    Bechdel_binary_desc = ifelse(Bechdel_binary == 0, "Fail", "Pass")
  ) %>%
  select(Gender_desc, Bechdel_binary_desc, count)  # Select only the semantic columns

# Display the results with semantic descriptions on the left
print(counts)
```

## Analysis

In the analysis phase, we aim to applie statistical models to investigate the relationships between passing the Bechdel Test and various film performance metrics. Specifically, our focus is understanding if passing the Bechdel Test significantly correlates with higher revenue, more award wins, and improved IMDb ratings. Furthermore, we want to create predictive models for estimating a film's likelihood of passing the Bechdel Test based on features like budget, genre, and director.

1.  **Correlation Analysis for Bechdel Test Result and Revenue**

    This code performs a Pearson correlation test to determine if there is a statistically significant relationship between `Bechdel_test_result` and `Revenue`.

    ```{r}
    # Convert columns to numeric if necessary
    df_unique$Bechdel_test_result <- as.numeric(df_unique$Bechdel_test_result)
    df_unique$Revenue <- as.numeric(df_unique$Revenue)

    # Perform correlation test again
    correlation_test <- cor.test(df_unique$Bechdel_test_result, df_unique$Revenue, method = "pearson")
    print(correlation_test)
    ```

    The Pearson correlation test between Bechdel_test_result and Revenue yielded a correlation coefficient of approximately -0.095, with a p-value of 8.532e-05. This result indicates a small but statistically significant negative correlation between passing the Bechdel Test and revenue. The 95% confidence interval for this correlation ranges from -0.141 to -0.048, suggesting that the true correlation is likely weakly negative.

    #### Key Findings:

    -   **Correlation Value**: The correlation coefficient of -0.095 implies a weak inverse relationship, where films that pass the Bechdel Test tend to have slightly lower revenues on average. However, given the small magnitude of this correlation, the effect is minor.

    -   **Statistical Significance**: The p-value (\< 0.0001) shows that this negative correlation is statistically significant, meaning it is unlikely to be due to random chance.

    #### Conclusion:

    While there is a statistically significant relationship between passing the Bechdel Test and revenue, the effect size is minimal, suggesting that passing the test is not a strong predictor of a film’s financial performance. This finding implies that other factors (such as budget, genre, and marketing) likely play a much more substantial role in determining a film's revenue than its performance on the Bechdel Test.

2.  **Logistic Regression for Awards and IMDb Ratings**

    In this section we will create some models to help us determine if passing the Bechdel Test is a predictor of critical acclaim. We will use a logistic regression for **award model and** The **imdb_rating_model** uses linear regression to estimate IMDb rating as a continuous variable

    ```{r}
    # Create a binary variable `awards` indicating whether the film won any awards (1 if Wins > 0, else 0)
    df_unique$awards <- ifelse(df_unique$Wins > 0, 1, 0)

    # Logistic regression for binary outcome (awards)
    award_model <- glm(awards ~ Bechdel_test_result + Budget + Genre, data = df_unique, family = binomial)
    summary(award_model)

    # Linear regression for continuous IMDb ratings
    imdb_rating_model <- lm(Imdb_Rating ~ Bechdel_test_result + Budget + Genre, data = df_unique)
    summary(imdb_rating_model)
    ```

    #### **Logistic Regression Model for Awards**

    The logistic regression model predicts the likelihood of a film winning at least one award based on its Bechdel Test result, budget, and genre.

    #### **Key Findings**:

    -   **Bechdel Test Result**: The coefficient for `Bechdel_test_result` is -0.097, which is not statistically significant (`p = 0.441`). This indicates that passing the Bechdel Test does not have a meaningful impact on a film's likelihood of winning awards.

    -   **Budget**: The budget has a highly significant positive effect (`p < 0.001`). With an estimated coefficient of 9.458×10−99.458 \times 10^{-9}9.458×10−9, films with higher budgets are more likely to win awards. Although the effect size seems small due to budget scaling, it remains a strong predictor.

    -   **Genres**: Several genres show significant effects on award wins:

        -   **Animation**, **Biography**, **Comedy**, **Crime**, and **Drama** all have positive and statistically significant coefficients, suggesting these genres are more likely to win awards.

        -   **Documentary**, **Horror**, **Fantasy**, and others do not show significant effects, indicating no clear relationship with award success.

    #### **Conclusion**: 

    Budget and certain genres are significant predictors of award wins, whereas passing the Bechdel Test does not seem to increase a film’s award potential. This implies that industry recognition through awards is more influenced by production investment and genre than by diversity indicators like the Bechdel Test.

    #### Linear Regression Model for IMDb Ratings 

    The linear regression model assesses how a film’s Bechdel Test result, budget, and genre are related to IMDb ratings.

    #### **Key Findings**:

    -   **Bechdel Test Result**: The coefficient for `Bechdel_test_result` is -0.275, which is statistically significant (`p < 0.001`). This negative coefficient suggests that films passing the Bechdel Test have slightly lower IMDb ratings on average, although the effect size is small.

    -   **Budget**: The budget coefficient is not statistically significant (`p = 0.369`), indicating that budget alone does not strongly influence IMDb ratings.

    -   **Genres**: Several genres have a significant impact on IMDb ratings:

        -   **Adventure**, **Animation**, **Biography**, **Comedy**, **Crime**, **Documentary**, and **Drama** are all positively associated with higher IMDb ratings.

        -   **Horror** and **Music** have negative, significant coefficients, suggesting that films in these genres tend to have slightly lower IMDb ratings on average.

    #### **Model Fit**: 

    The adjusted R2R^2R2 value of 0.124 indicates that only about 12.4% of the variability in IMDb ratings is explained by this model, suggesting other unaccounted factors may significantly influence IMDb ratings.

    #### **Conclusion**: 

    While passing the Bechdel Test is associated with a slight decrease in IMDb ratings, the effect is minimal. Genre remains a more influential factor, with genres like **Biography** and **Documentary** positively associated with higher ratings. This outcome suggests that audience ratings on IMDb are more closely tied to genre preferences than to a film's adherence to gender diversity metrics.

    #### Overall Conclusion

    From both models, it is clear that genre and budget are more powerful predictors of a film’s critical success (as measured by awards and IMDb ratings) than passing the Bechdel Test. While the Bechdel Test serves as a valuable tool for analyzing gender representation, these findings suggest that its impact on industry recognition and audience ratings is limited. Future analyses could explore other diversity metrics or interactions to provide a more nuanced understanding of representation’s role in film success.

3.  **Predictive Model for Film Success (Revenue, Awards, IMDb Ratings)**

    In this section we will build a predictive model to estimate a film’s success on revenue terms based on the Bechdel Test results, budget, genre of fils, and gender of directors.

    ```{r}


    # Linear regression for Revenue (continuous outcome)
    revenue_model <- lm(Revenue ~ Bechdel_test_result + Budget + Genre + Gender, data = df_unique)
    summary(revenue_model)



    ```

    -   

    #### **Key Findings**:

    **Budget** and certain **genres** appear to significantly as in the model before, they influence revenue. Specifically, the budget has a strong positive effect on revenue, with a coefficient estimate of **3.04** (p \< 2e-16).

    **Genres** such as Adventure, Animation, Horror, and Musical also significantly affect revenue, with Adventure and Musical showing the strongest positive relationships (p-values \< 0.05).

    **Bechdel Test Result**, **Gender**, and many other genres (e.g., Biography, Comedy, Drama) were not statistically significant (p \> 0.05). This suggests that the Bechdel test result and gender have less influence on revenue in this dataset..

    #### **Conclusion:**

    The linear regression analysis of revenue reveals that **budget** and specific **genres** are the most significant predictors of a film's revenue. A higher budget is strongly associated with increased revenue, highlighting the crucial role of financial investment in a film's commercial success. Genres such as **Adventure**, **Animation**, and **Musical** also show significant positive relationships with revenue, indicating that films in these genres tend to perform better financially. On the other hand, **Bechdel Test Result** and **Gender** do not appear to significantly influence revenue, suggesting that factors like gender representation and passing the Bechdel test may not directly affect a film's box office performance in this dataset.
